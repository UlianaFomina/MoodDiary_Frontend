import React, { useEffect, useState } from "react";
import "./header.css";
import { useNavigate } from "react-router-dom";
import avatar from "../../assets/avatar.jpg";
import { getById } from "../../service/user";

export const Header = () => {
  const navigate = useNavigate();
  const [imageUrl, setImageUrl] = useState(avatar);
  const logout = () => {
    navigate("/");
    sessionStorage.removeItem("token");
  };
  let id = sessionStorage.getItem("id");

  const fetchUserImage = () => {
    getById(id)
      .then((resp) => {
        setImageUrl(resp.imageUrl);
      })
      .catch((e) => console.log(e));
  };

  useEffect(() => {
    fetchUserImage();
  });

  return (
    <div className={"header"}>
      <div className={"header-high"}>
        <a href={"/main"} className={"header-link"}>
          <svg
            width="85px"
            height="55px"
            className="header-link-svg header-logo-svg"
            viewBox="0 0 1450 800"
          >
            <g transform="translate(0.000000,852.000000) scale(0.100000,-0.100000)">
              <path d="m7300 8099 c-381 -38 -716 -155 -1023 -359 -358 -237 -628 -552 -804 -935 -110 -241 -193 -589 -193 -814 l0 -91 94 0 94 0 6 68 c33 340 117 639 243 871 240 440 584 749 1032 925 301 119 674 159 1014 110 60 -9 265 -60 337 -84 406 -137 778 -425 1012 -785 196 -301 304 -629 343 -1037 l7 -68 95 0 96 0 -6 123 c-12 245 -93 580 -195 799 -109 235 -272 459 -478 659 -243 236 -483 386 -794 494 -275 96 -641 148 -880 124z" />
              <path d="m7220 7525 c-614 -104 -1097 -515 -1303 -1110 -56 -163 -62 -212 -62 -500 0 -288 6 -337 62 -500 97 -282 237 -497 453 -693 312 -284 684 -432 1088 -433 333 0 620 88 900 275 249 166 429 369 559 631 292 588 207 1269 -222 1785 -183 220 -498 415 -809 502 -199 55 -485 74 -666 43z m538 -219 c417 -83 788 -379 996 -794 107 -212 132 -345 123 -642 -9 -270 -31 -365 -135 -575 -297 -600 -980 -922 -1617 -760 -258 65 -464 183 -660 380 -205 204 -330 423 -387 678 -20 90 -23 129 -23 327 0 259 11 332 76 495 190 479 634 839 1114 904 105 14 415 6 513 -13z" />
              <path d="m6830 6340 l0 -170 100 0 100 0 0 170 0 170 -100 0 -100 0 0 -170z" />
              <path d="m7900 6340 l0 -170 100 0 100 0 0 170 0 170 -100 0 -100 0 0 -170z" />
              <path d="m6815 5483 c-61 -39 -85 -64 -85 -90 0 -50 219 -248 362 -328 79 -44 225 -75 352 -75 293 0 474 81 688 308 102 108 101 102 13 162 l-76 51 -102 -98 c-162 -156 -312 -222 -508 -223 -189 0 -326 61 -490 218 -58 56 -108 102 -110 101 -2 0 -22 -12 -44 -26z" />
              <path d="m2406 5647 c-45 -33 -70 -309 -42 -477 65 -396 320 -712 661 -820 144 -46 456 -33 493 20 11 15 19 17 43 10 39 -11 59 -3 59 24 0 17 -18 30 -97 66 -148 68 -263 149 -399 285 -142 140 -227 253 -466 617 -190 288 -208 307 -252 275z m208 -420 c166 -261 261 -390 378 -513 103 -107 204 -187 304 -239 l69 -36 -120 4 c-97 4 -136 10 -200 31 -297 101 -512 363 -570 693 -16 94 -20 273 -6 273 5 0 70 -96 145 -213z" />
              <path d="m12118 5633 c-9 -10 -98 -142 -198 -293 -101 -151 -217 -320 -258 -375 -100 -132 -275 -305 -388 -382 -86 -59 -261 -153 -283 -153 -6 0 -11 -12 -11 -26 0 -25 2 -26 42 -22 30 3 47 -1 59 -13 45 -45 329 -60 459 -25 155 42 288 124 410 252 170 178 266 394 292 655 10 99 9 134 -5 234 -9 64 -23 128 -32 141 -19 29 -65 32 -87 7z m22 -282 c0 -410 -239 -762 -595 -877 -59 -19 -110 -27 -195 -31 l-115 -5 83 48 c230 133 398 320 673 753 74 115 137 207 141 205 5 -3 8 -45 8 -93z" />
              <path d="m1358 4753 c-24 -27 -57 -139 -68 -229 -24 -193 36 -363 175 -492 121 -114 279 -172 465 -172 166 0 318 48 438 137 91 68 85 80 -60 117 -119 30 -209 66 -323 129 -174 95 -361 258 -475 412 -86 118 -117 138 -152 98z m187 -312 c156 -165 373 -306 555 -361 41 -13 82 -25 90 -27 9 -3 -1 -11 -25 -20 -123 -45 -314 -57 -415 -27 -228 68 -344 216 -343 439 0 50 3 101 7 114 8 23 8 23 39 -15 17 -22 59 -68 92 -103z" />
              <path d="m13154 4736 c-16 -18 -56 -68 -89 -111 -77 -100 -216 -229 -328 -307 -143 -98 -269 -152 -512 -220 -72 -20 -71 -42 2 -97 162 -122 396 -170 608 -126 225 47 422 235 465 442 26 125 -7 379 -58 436 -24 27 -57 21 -88 -17z m34 -304 c-3 -106 -6 -123 -35 -184 -41 -88 -98 -148 -181 -191 -111 -58 -168 -70 -306 -64 -91 3 -139 11 -196 30 -41 13 -68 27 -60 29 8 3 42 13 75 23 137 39 306 134 446 251 76 63 179 168 221 224 19 26 23 28 31 14 5 -9 7 -68 5 -132z" />
              <path d="m10195 3201 c-6 -5 -28 -11 -49 -13 -49 -4 -47 2 -76 -245 -11 -104 -45 -309 -75 -458 -30 -148 -71 -369 -90 -490 -40 -246 -111 -617 -148 -772 -21 -87 -23 -105 -11 -121 35 -50 81 -26 109 58 21 64 52 229 61 323 4 50 12 81 20 84 20 7 376 -15 385 -24 5 -5 20 -105 35 -223 28 -233 38 -263 82 -258 50 6 51 25 15 310 -57 456 -102 843 -133 1153 -17 165 -35 341 -40 390 -5 50 -10 127 -10 173 0 69 -3 85 -20 102 -22 22 -41 25 -55 11z m40 -661 c42 -453 75 -842 75 -883 l0 -30 -117 7 c-138 7 -220 19 -234 33 -16 16 6 152 107 668 106 532 127 629 131 600 2 -11 19 -189 38 -395z" />
              <path d="m10882 3189 c-49 -18 -52 -36 -52 -304 0 -227 9 -623 25 -1115 25 -752 20 -710 71 -710 39 0 46 36 35 169 -14 159 -18 237 -32 605 -12 310 -12 319 7 333 10 8 33 13 49 11 23 -2 34 -11 48 -40 25 -52 61 -202 103 -428 72 -398 126 -603 169 -646 30 -30 71 -32 80 -4 7 23 -8 77 -35 124 -15 26 -170 638 -240 948 l-22 96 60 124 c102 209 106 226 106 423 1 190 -10 242 -64 307 -41 50 -138 96 -221 106 -37 5 -76 5 -87 1z m174 -100 c107 -51 140 -263 83 -528 -33 -151 -87 -254 -149 -286 -60 -31 -56 -50 -64 383 -5 270 -4 406 3 425 9 23 16 27 48 27 20 0 56 -9 79 -21z" />
              <path d="m4299 3165 c-75 -41 -133 -215 -158 -475 -12 -126 -12 -765 0 -910 26 -314 89 -546 179 -660 40 -50 120 -90 179 -90 126 1 227 112 285 314 51 173 59 261 63 691 6 566 -18 753 -124 957 -48 92 -96 134 -163 143 -29 4 -83 16 -119 26 -78 22 -107 23 -142 4z m241 -105 c55 -28 97 -75 132 -147 33 -70 42 -142 53 -413 4 -91 10 -205 15 -255 11 -120 5 -568 -9 -675 -13 -98 -53 -253 -80 -314 -40 -91 -120 -148 -184 -132 -150 37 -238 403 -237 990 0 116 5 261 10 321 6 61 13 171 16 245 11 285 22 329 94 378 44 29 134 31 190 2z" />
              <path d="m5393 3167 c-81 -45 -140 -233 -162 -516 -14 -171 -14 -658 -1 -827 42 -538 158 -794 360 -794 168 0 285 189 332 535 18 141 19 969 0 1075 -34 189 -75 311 -135 402 -42 62 -74 83 -142 94 -27 4 -79 15 -115 25 -75 22 -106 23 -137 6z m231 -102 c51 -22 109 -82 140 -148 29 -62 40 -150 51 -387 3 -74 10 -209 17 -300 13 -201 5 -569 -16 -700 -40 -249 -112 -387 -211 -406 -150 -28 -243 211 -275 702 -12 193 -12 452 0 594 5 58 14 195 20 305 12 254 23 293 93 335 39 24 129 27 181 5z" />
              <path d="m6371 3154 c-35 -29 -39 -58 -13 -94 16 -23 17 -84 18 -915 1 -861 5 -1036 26 -1062 7 -9 44 -13 118 -13 l107 0 59 39 c185 120 260 247 298 501 27 178 56 441 50 451 -3 5 -6 114 -8 241 -3 234 -14 327 -49 410 -32 77 -131 210 -203 275 -100 90 -117 100 -198 118 -42 10 -86 28 -110 46 -49 36 -56 36 -95 3z m244 -148 c101 -47 174 -140 235 -298 47 -122 60 -204 71 -463 25 -560 -32 -820 -219 -1002 -73 -72 -75 -73 -127 -73 -51 0 -53 1 -59 33 -4 17 -9 70 -12 117 -2 47 -9 159 -14 250 -26 425 -22 1371 5 1443 10 24 59 22 120 -7z" />
              <path d="m8011 3154 c-35 -29 -39 -58 -14 -94 16 -23 17 -93 18 -955 1 -511 5 -948 10 -970 12 -63 16 -65 134 -65 103 0 109 1 156 31 143 91 227 196 271 339 20 66 41 176 48 250 4 36 15 130 25 210 11 87 15 153 10 167 -4 12 -8 120 -8 240 1 283 -14 363 -93 491 -53 86 -138 180 -230 252 -36 29 -66 43 -123 55 -50 11 -87 27 -111 46 -45 36 -54 36 -93 3z m225 -139 c55 -23 119 -73 153 -121 67 -92 141 -277 155 -384 11 -92 19 -301 19 -500 0 -402 -60 -609 -221 -767 -73 -72 -75 -73 -127 -73 -46 0 -54 3 -60 23 -8 23 -8 31 -28 422 -24 469 -19 1361 8 1405 9 15 60 12 101 -5z" />
              <path d="m12122 3143 c-26 -52 -53 -158 -107 -421 -25 -123 -52 -242 -59 -265 -8 -23 -17 -59 -21 -81 -6 -37 -7 -38 -21 -18 -14 21 -48 121 -160 482 -57 185 -94 283 -111 293 -5 3 -19 -3 -33 -13 l-24 -18 28 -103 c24 -90 196 -580 258 -738 12 -30 23 -70 24 -90 2 -20 8 -76 15 -126 13 -104 18 -742 6 -887 -7 -90 -6 -98 12 -108 82 -43 104 135 80 640 -7 151 -12 307 -12 345 0 39 0 88 0 110 0 22 1 76 1 120 1 104 26 226 110 525 106 373 108 390 58 390 -19 0 -30 -9 -44 -37z" />
              <path d="m2480 3150 c-16 -16 -18 -24 -9 -47 18 -45 3 -398 -46 -1128 -13 -198 -30 -480 -36 -628 l-12 -267 23 -25 c28 -30 60 -32 83 -7 15 16 17 45 17 198 0 254 43 1224 68 1519 l7 90 32 -82 c90 -226 301 -1077 337 -1355 17 -129 32 -151 94 -146 49 4 70 37 87 138 24 134 180 760 261 1040 77 271 113 372 129 371 16 -1 21 -113 12 -291 -8 -168 -5 -272 14 -460 5 -58 13 -321 18 -585 6 -412 9 -485 24 -517 12 -29 22 -38 40 -38 55 0 82 70 60 156 -10 42 -16 139 -19 339 -3 154 -9 318 -14 365 -6 47 -15 364 -21 705 -5 341 -12 626 -15 633 -2 7 -19 19 -38 27 -45 19 -79 5 -100 -40 -9 -18 -29 -99 -46 -181 -55 -264 -248 -985 -337 -1256 -39 -118 -48 -137 -50 -108 -10 115 -83 442 -113 500 -10 19 -31 91 -48 160 -45 183 -95 341 -147 465 -81 192 -105 264 -115 352 -6 55 -15 92 -26 104 -23 26 -88 25 -114 -1z" />
              <path d="m8970 3157 c-29 -14 -37 -41 -20 -62 9 -11 37 -15 111 -15 67 0 100 -4 106 -12 4 -7 8 -319 8 -693 0 -374 4 -779 9 -900 10 -267 8 -275 -62 -275 -35 0 -54 -5 -65 -18 -35 -38 -8 -62 70 -62 26 0 57 -7 67 -15 25 -19 67 -19 113 0 25 10 64 15 119 14 53 -2 88 2 97 10 25 20 27 51 6 72 -16 16 -33 19 -110 19 -136 0 -129 -11 -130 198 0 97 -6 290 -12 427 -8 167 -9 366 -4 600 4 193 5 410 2 484 l-5 133 48 -6 c113 -16 155 -3 128 39 -19 29 -96 52 -220 64 -143 14 -225 14 -256 -2z" />
              <path d="m906 2024 c-22 -21 -20 -40 6 -58 19 -14 72 -16 370 -16 302 0 349 2 362 16 22 21 20 51 -3 64 -13 6 -148 10 -370 10 -304 0 -352 -2 -365 -16z" />
              <path d="m12953 2028 c-22 -29 -23 -38 -3 -58 19 -19 31 -20 366 -20 219 0 352 4 365 10 21 12 25 50 7 68 -18 18 -722 17 -735 0z" />
            </g>
          </svg>
        </a>
        <a href={"/new-entry"} className={"header-link"}>
          <svg className="header-link-svg" viewBox="0 0 128 128">
            <path d="M 64 6.0507812 C 49.15 6.0507812 34.3 11.7 23 23 C 0.4 45.6 0.4 82.4 23 105 C 34.3 116.3 49.2 122 64 122 C 78.8 122 93.7 116.3 105 105 C 127.6 82.4 127.6 45.6 105 23 C 93.7 11.7 78.85 6.0507812 64 6.0507812 z M 64 12 C 77.3 12 90.600781 17.099219 100.80078 27.199219 C 121.00078 47.499219 121.00078 80.500781 100.80078 100.80078 C 80.500781 121.10078 47.500781 121.10078 27.300781 100.80078 C 7.0007813 80.500781 6.9992188 47.499219 27.199219 27.199219 C 37.399219 17.099219 50.7 12 64 12 z M 64 42 C 62.3 42 61 43.3 61 45 L 61 61 L 45 61 C 43.3 61 42 62.3 42 64 C 42 65.7 43.3 67 45 67 L 61 67 L 61 83 C 61 84.7 62.3 86 64 86 C 65.7 86 67 84.7 67 83 L 67 67 L 83 67 C 84.7 67 86 65.7 86 64 C 86 62.3 84.7 61 83 61 L 67 61 L 67 45 C 67 43.3 65.7 42 64 42 z" />
          </svg>
        </a>
        <a href={"/statistics"} className={"header-link"}>
          <svg className="header-link-svg" viewBox="100 100 210 210">
            <g transform="matrix(12.5 0 0 12.5 200 200)">
              <path
                transform=" translate(-8, -8)"
                d="M 0 0 h 1 v 15 h 15 v 1 H 0 V 0 Z m 14.817 3.113 a 0.5 0.5 0 0 1 0.07 0.704 l -4.5 5.5 a 0.5 0.5 0 0 1 -0.74 0.037 L 7.06 6.767 l -3.656 5.027 a 0.5 0.5 0 0 1 -0.808 -0.588 l 4 -5.5 a 0.5 0.5 0 0 1 0.758 -0.06 l 2.609 2.61 l 4.15 -5.073 a 0.5 0.5 0 0 1 0.704 -0.07 Z"
                strokeLinecap="round"
              />
            </g>
          </svg>
        </a>
        <a href={"/planing"} className={"header-link"}>
          <svg className="header-link-svg" viewBox="100 100 210 210">
            <g transform="matrix(12.5 0 0 12.5 200 200)">
              <path
                transform=" translate(-8, -8)"
                d="M 0 0 h 1 v 15 h 15 v 1 H 0 V 0 Z m 14.817 3.113 a 0.5 0.5 0 0 1 0.07 0.704 l -4.5 5.5 a 0.5 0.5 0 0 1 -0.74 0.037 L 7.06 6.767 l -3.656 5.027 a 0.5 0.5 0 0 1 -0.808 -0.588 l 4 -5.5 a 0.5 0.5 0 0 1 0.758 -0.06 l 2.609 2.61 l 4.15 -5.073 a 0.5 0.5 0 0 1 0.704 -0.07 Z"
                strokeLinecap="round"
              />
            </g>
          </svg>
        </a>
      </div>
      <div className={"header-high"}>
        <a href="/profile" className="header-link">
          <img
            className="header-link-avatar"
            onError={(e) => (e.target.src = avatar)}
            src={imageUrl ? imageUrl : avatar}
            alt="avatar"
          />
        </a>
        <span onClick={logout} className="header-link">
          <svg
            viewBox="0 0 24 24"
            className="header-link-svg header-logout-svg"
          >
            <path d="M3 13H15V11H3V13Z" />
            <path d="M5.79282 7.79291L2.29282 11.2929C1.90229 11.6834 1.90229 12.3166 2.29282 12.7071L5.79282 16.2071L7.20703 14.7929L4.41414 12L7.20703 9.20712L5.79282 7.79291Z" />
            <path d="M8 4C8 3.44772 8.44772 3 9 3H21C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H9C8.44772 21 8 20.5523 8 20V17H10V19H20V5H10V7H8V4Z" />
          </svg>
        </span>
      </div>
    </div>
  );
};
